<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>いぶかつ☆にゅーす - development</title><link href="https://evekatsu.github.io/news/" rel="alternate"></link><link href="https://evekatsu.github.io/news/feeds/development.atom.xml" rel="self"></link><id>https://evekatsu.github.io/news/</id><updated>2018-09-21T00:00:00+09:00</updated><entry><title>名前から所属を取得するGAS</title><link href="https://evekatsu.github.io/news/%E5%90%8D%E5%89%8D%E3%81%8B%E3%82%89%E6%89%80%E5%B1%9E%E3%82%92%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8BGAS.html" rel="alternate"></link><published>2018-09-21T00:00:00+09:00</published><updated>2018-09-21T00:00:00+09:00</updated><author><name>Administrator</name></author><id>tag:evekatsu.github.io,2018-09-21:/news/名前から所属を取得するGAS.html</id><summary type="html">&lt;p&gt;とあるネクロフィリア（死体愛好者）から「死体を管理するのにキャラクター名だけだと不便だからコーポレーション名やアライアンス名を取得できないか？」と頼まれたので作ってみました。&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://gist.github.com/EVEKatsu/9242e577e17a2eac6a7a0f29557887ae"&gt;gas-find-affiliations.gs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Googleスプレッドシートでキャラクター名のリストから、その所属を&lt;a href="https://evewho.com/"&gt;Eve Who&lt;/a&gt;のAPIから取得するGoogle Apps Scriptです。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-1" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-1.jpg"&gt;
完成図としては上記のような感じになります。次にこの形に持っていく手順を説明します。&lt;/p&gt;
&lt;h3&gt;リストの作り方&lt;/h3&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-2" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-2.jpg"&gt;
私が知ってる限りではゲーム内からキャラクター名のリストを作る方法は2つあります。&lt;/p&gt;
&lt;p&gt;1つ目は、チャットのメンバー一覧のところにマウスのフォーカスを合わせてCtrl+A → Ctrl+Cでキャラクター名の一覧がコピーができます。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-3" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-3.jpg"&gt;
次にスプレットシートを開いてCtrl+Vで貼り付けが出来ます。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-4" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-4.jpg"&gt;
2つ目は、Item hangarからリストを取ってくる方法です。&lt;/p&gt;
&lt;p&gt;残念ながら私は死体のコレクションをする趣味はなかったのでテストはできませんでしたが、多分これでも可能なはずです。&lt;/p&gt;
&lt;p&gt;とりあえず、今回は仕方ないので適当なモジュールを例にします。&lt;/p&gt;
&lt;p&gt;死体はアイテムなので、そのリストを作りたい場合はまず死体のみをStation Container等にいれます。&lt;/p&gt;
&lt;p&gt;そしてアイテムの表示をListに変更し、Name以外を全てHide（非表示）にします。&lt;/p&gt;
&lt;p&gt;その状態でCtrl+A → Ctrl+Cでキャラクター名の一覧がコピーできます。そして同じようにCtrl+Vでスプレッドシートに貼り付けます。&lt;/p&gt;
&lt;h3&gt;スクリプトの実行&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://drive.google.com/drive/my-drive"&gt;https://drive.google.com …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;とあるネクロフィリア（死体愛好者）から「死体を管理するのにキャラクター名だけだと不便だからコーポレーション名やアライアンス名を取得できないか？」と頼まれたので作ってみました。&lt;/p&gt;
&lt;p&gt;&lt;br /&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://gist.github.com/EVEKatsu/9242e577e17a2eac6a7a0f29557887ae"&gt;gas-find-affiliations.gs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Googleスプレッドシートでキャラクター名のリストから、その所属を&lt;a href="https://evewho.com/"&gt;Eve Who&lt;/a&gt;のAPIから取得するGoogle Apps Scriptです。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-1" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-1.jpg"&gt;
完成図としては上記のような感じになります。次にこの形に持っていく手順を説明します。&lt;/p&gt;
&lt;h3&gt;リストの作り方&lt;/h3&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-2" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-2.jpg"&gt;
私が知ってる限りではゲーム内からキャラクター名のリストを作る方法は2つあります。&lt;/p&gt;
&lt;p&gt;1つ目は、チャットのメンバー一覧のところにマウスのフォーカスを合わせてCtrl+A → Ctrl+Cでキャラクター名の一覧がコピーができます。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-3" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-3.jpg"&gt;
次にスプレットシートを開いてCtrl+Vで貼り付けが出来ます。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-4" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-4.jpg"&gt;
2つ目は、Item hangarからリストを取ってくる方法です。&lt;/p&gt;
&lt;p&gt;残念ながら私は死体のコレクションをする趣味はなかったのでテストはできませんでしたが、多分これでも可能なはずです。&lt;/p&gt;
&lt;p&gt;とりあえず、今回は仕方ないので適当なモジュールを例にします。&lt;/p&gt;
&lt;p&gt;死体はアイテムなので、そのリストを作りたい場合はまず死体のみをStation Container等にいれます。&lt;/p&gt;
&lt;p&gt;そしてアイテムの表示をListに変更し、Name以外を全てHide（非表示）にします。&lt;/p&gt;
&lt;p&gt;その状態でCtrl+A → Ctrl+Cでキャラクター名の一覧がコピーできます。そして同じようにCtrl+Vでスプレッドシートに貼り付けます。&lt;/p&gt;
&lt;h3&gt;スクリプトの実行&lt;/h3&gt;
&lt;p&gt;&lt;a href="https://drive.google.com/drive/my-drive"&gt;https://drive.google.com/drive/my-drive&lt;/a&gt;&lt;br&gt;
Google Driveにアクセスします。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-5" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-5.jpg"&gt;
①新規 → ②Googleスプレッドシート → ③空白のスプレッドシート&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-6" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-6.jpg"&gt;
①ツール → ②スクリプトエディタ&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-7" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-7.jpg"&gt;
&lt;a href="https://gist.githubusercontent.com/EVEKatsu/9242e577e17a2eac6a7a0f29557887ae/raw/c7bdbc01c942543f64d9b0adc58161cdc5da50ab/gas-find-affiliations.gs"&gt;このリンク先のGistからスクリプトをCtrl+A → Ctrl+C&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;『コード.gs』のエディタ画面にCtrl+V（貼り付け）をして①ファイル → ②すべてを保存。&lt;/p&gt;
&lt;p&gt;『プロジェクト名の編集』という画面が出るので『OK』をクリックして、スクリプトエディタを閉じます。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-8" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-8.jpg"&gt;
①ブラウザの『再読み込み』をクリック。&lt;br&gt;
↓&lt;br&gt;
②新しくEve Whoというメニューが出るのでTicker On / Offのどちらかを選択します。&lt;/p&gt;
&lt;p&gt;TickerのOnとOffの違いは、Tickerを表示するかどうかです。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-9" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-9.jpg"&gt;
『承認が必要』という画面が出るので『続行』&lt;br&gt;
↓&lt;br&gt;
『アカウントの選択』で自分のGoogleアカウントを選択&lt;br&gt;
↓&lt;br&gt;
『このアプリは確認されていません』と出るので『詳細』をクリックして『無題のプロジェクト（安全でないページ）に移動』をクリック。&lt;/p&gt;
&lt;p&gt;&lt;img alt="名前から所属を取得するGAS-10" src="https://evekatsu.github.io/news/images/名前から所属を取得するGAS-10.jpg"&gt;
許可する権限を確認します。&lt;br&gt;
このスクリプトで必要な権限は次の3つです。&lt;/p&gt;
&lt;h4&gt;Google ドライブのスプレッドシートの表示と管理&lt;/h4&gt;
&lt;p&gt;シートにデータの書き込みをします。&lt;/p&gt;
&lt;p&gt;使用しているメソッド例：&lt;a href="https://developers.google.com/apps-script/reference/spreadsheet/range#setValue(Object)"&gt;Range.setValue&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;自分がいないときにこのアプリケーションを実行できるようにします&lt;/h4&gt;
&lt;p&gt;Google Apps Scriptは5分以上のスクリプトを走らすことができません。&lt;/p&gt;
&lt;p&gt;その壁を超えるためにトリガー登録をして何回かに分けてバックグラウンドで実行します。&lt;/p&gt;
&lt;p&gt;これをすることで大量のデータを処理する時にブラウザやPCを終了しても大丈夫になります。&lt;/p&gt;
&lt;p&gt;使用しているメソッド例: &lt;a href="https://developers.google.com/apps-script/reference/script/script-app#newtriggerfunctionname"&gt;ScriptApp.newTrigger&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;外部サービスへの接続&lt;/h4&gt;
&lt;p&gt;Eve WhoのAPIからコーポレーションやアライアンスの情報を取得するのに使います。&lt;/p&gt;
&lt;p&gt;使用しているメソッド例：&lt;a href="https://developers.google.com/apps-script/guides/services/external#work_with_json"&gt;JSON.parse&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;おわり&lt;/h3&gt;
&lt;p&gt;以上でスクリプトが走り始めます。先程も言ったようにGoogle Apps Scriptは5分以上の処理ができないので、トリガーに登録をして小分けで処理を行います。&lt;/p&gt;
&lt;p&gt;ですので、実行してもすぐには始まらないかもしれませんが、1-2分ぐらい待ってたら動き始めます。ブラウザやPCを閉じてても勝手に実行するので問題ありません。&lt;/p&gt;
&lt;h3&gt;アイデアを募集中&lt;/h3&gt;
&lt;p&gt;いぶかつでは面白そうなアイデアを募集しています。&lt;/p&gt;
&lt;p&gt;ビジネスとしての取引は行いません。ですので以下の条件でもオッケーだよという方で何かCOOLなことを思いついた人はTwitter or Discordの方にお願います！&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ソースコードは公開してコミュニティ全体で共有する&lt;/li&gt;
&lt;li&gt;金銭のやり取りはしない（寄付は大歓迎です☆）&lt;/li&gt;
&lt;li&gt;実際に作るかどうかは気分次第&lt;/li&gt;
&lt;li&gt;締切などの期日は設けない&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;技術的なお問い合わせや質問など&lt;/h3&gt;
&lt;p&gt;Discord: &lt;a href="https://t.co/lTtTmpOgy8"&gt;EVE Japanese IT&lt;/a&gt;&lt;br&gt;
Twitter: &lt;a href="https://twitter.com/evekatsu"&gt;@evekatsu&lt;/a&gt;  &lt;/p&gt;
&lt;p&gt;こちらのほうにお願いします。&lt;br&gt;
Twitterの方はフォロー外にDMを解放しています。&lt;/p&gt;</content><category term="Development"></category><category term="Google Apps Script"></category></entry></feed>