Title: 新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる
Date: 2019-4-5
Slug: 新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる
Tags: Development, Python, zKillboard

みなさん？PvPはやっていますか？唐突ですがEVE Onlineには

<br /><br />
<b style="font-size: 300%;">[zKillboard](https://zkillboard.com/)</b>
<br /><br /><br /><br />

というウルトラスーパーミラクル便利なサービスがあります。

<br /><br />
<b style="font-size: 150%;">[というネタを前回やりました](https://evekatsu.github.io/news/zKillboard%E3%81%8B%E3%82%89%E3%82%AD%E3%83%AB%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%93%E3%81%A7Excel%E3%81%8BCSV%E3%81%A7%E5%87%BA%E5%8A%9B.html)</b>
<br /><br />

<br />
な、なななんと！！！今回はそのスクリプトを
<br />

<br /><br />
<b style="font-size: 150%; color: #f26a3d">非エンジニアでも使えるようにアプリケーション(GUI)化しました！</b>
<br /><br />


<br /><br />
<b style="font-size: 200%;">[ここからダウンロードできます！](https://drive.google.com/open?id=1YTu3482Lyrz1RkkziWn-kDxJ2SDMEVOY)</b>

![新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる-1]({static}/images/新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる/新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる-1.jpg)

画面の右上の↓みたいなアイコンをクリックするとダウンロードができます。

[ソースコードはこちらです。](https://github.com/EVEKatsu/zkillboard2excel)

今のところはWindows 10の64bit版で動作確認しています。

32bit版を用意するか悩んですが私の手元に32bit端末がないので64bit版だけ用意しました。

まぁEVE Onlineも64bit化されるらしいので、そういう感じでヤッていきましょい。

適当な場所で解凍して、その中の 'zkillboard2excel.exe' をダブルクリックすると起動します。

念頭において欲しいことがありまして

<br />
<b style="font-size: 150%; color: #f26a3d">
これは開発版（というかさっき完成した）なので不具合がある可能性は大きい
</b>
<br /><br />

次にもっともっと大事なのは

<br />
<b style="font-size: 150%; color: #f26a3d">
私はExcelを持っていないのでまともにテストをしていない（できない）
</b>
<br /><br />

ということです。ですのでフィードバックをどんどん募集しています！

![新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる-2]({static}/images/新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる/新大陸でモンスターを狩る暇もなくポータルサイトを開発するわけでもなくエクセルを持ってすらいないカプセラが作ったキルボツールを公開してみる-2.jpg)

とりま起動したら自分のzKillboardのURLを入力して 'Export' というボタンを押してみてください。

色々とログが出て最後にデスクトップに 'export.xlsx' という名前のExcelが出力されます（そのはず）

最初は時間がかかりますが、どんどんキャッシュが溜まっていきます。

同じURLならキルボードが更新されていない場合は次は一瞬で終わります。

もし言語を変えてもキルメールのデータは一緒なので関係ありません。

では、軽く機能について説明します。[前回の記事](https://evekatsu.github.io/news/zKillboard%E3%81%8B%E3%82%89%E3%82%AD%E3%83%AB%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%93%E3%81%A7Excel%E3%81%8BCSV%E3%81%A7%E5%87%BA%E5%8A%9B.html)も合わせて読むと分かりやすいかもです。

# zKillboard URL

zKillboardでキルボードが表示されているのページのURLのキルメールが取れます（そのはず）

まず大前提として、これはExcelを使って統計をとるための補助ツールであって

<br />
<b style="font-size: 150%; color: #f26a3d">
キルメールのフィルタリングを想定して作られたツールではありません
</b>
<br /><br />

Excelを使ってキルメールの仕分けをするのは悪手（効率が悪い）です。

[フィルタリングはzKillboard上でやりましょう。そのための機能がzKillboardにはあります。](https://omochindev.tumblr.com/post/174047449362/elite-pvper%E3%82%92%E7%9B%AE%E6%8C%87%E3%81%99%E3%81%9F%E3%82%81%E3%81%AEzkillboard%E3%81%AE%E4%BD%BF%E3%81%84%E6%96%B9)

# File name

ファイルブラウザみたいなのを用意するのが面倒くさかったので、今のところは全てデスクトップの上に保存されます。

小技として ¥ を挟むとフォルダを掘れるのでデスクトップに死ぬほどExcelが溜まっていくのは最低限回避できます。

例えば 'zkill¥ja' と入力するとzkillフォルダが作られ、その中に 'ja.xlsx' or 'ja.csv' というファイルが出力されます。

# .xlsx or .csv

.xlsx は色やリンクが付いてて豪華です。

大量（1万件とか）のキルメールを読み込みたいとかの場合は .csv の方が確実に速いです。

# Page

読み込む最初のページを指定します。

キルメールは1ページに200件取得できます。

つまり '2' と入力すると201件目から取得できます。

# Limit

何ページ分読み込むかを指定できます。

例えばここに '100' と入力すると2万件のキルメールが取得できます。

# Clear cache

とにかくどんどん溜まっていくので、やればやるほどExcelを吐くのが早くなりますが、あまりにもキャッシュが溜まりすぎると不具合が出るかもです。

そんな時は 'Clear cache' のチェックボタンを付けて 'Export' を実行してみてください。

# Update SDE

新しい船とかが実装されたチェックしてアップデートしたほうがいいです。

しかし、これは[CCPが配布している死ぬほど重いデータ](https://developers.eveonline.com/resource/resources)を私の方で加工したデータを参照しているので、こちらがSDEを更新していない場合は反映されません。

# 下の画面(Console Log)

ログを出力します。

+ Start - スクリプトが走り始めた時
+ Done - スクリプトが終わった時
+ zkb - zKillboardのAPI読み込み
+ esi - ESI（CCPの用意しているAPI）の読み込み

# 終わりに

<br />
<b style="font-size: 150%; color: #f26a3d">
私自身はExcelを持っていませんしキルボードとかあんまりチェックしません（ぶっちゃけ）
</b>
<br />
